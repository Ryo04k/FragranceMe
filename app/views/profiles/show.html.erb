<div class="max-w-[1200px] mx-auto mb-20">
  <div class="mx-2 p-5">
    <h2 class="text-2xl md:text-3xl font-bold mt-6 mb-1 ml-2 md:ml-0">マイページ</h2>
    <p><%= @user.name %></p>

    <% if @latest_diagnosis %>
      <%= image_tag(@latest_diagnosis.fragrance.image_url, class: "w-96 h-auto rounded shadow-sm") %>

      <div class="mx-auto w-full h-full md:w-96 md:h-80 mt-4">
        <canvas id="myChart"></canvas>
      </div>
    <% else %>
      <p>診断結果はありません。</p>
    <% end %>
  </div>
</div>


<script type="text/javascript">
const ctx = document.getElementById('myChart');
const scores = <%= raw @scores.to_json %>;
// スマートフォン用のフォントサイズを設定
const isMobile = window.matchMedia('(max-width: 640px)').matches; // 640px以下の場合

const myChart = new Chart(ctx, {
    type: 'radar',
    data: {
        labels: ['フローラル', '柑橘', 'スパイシー', 'オリエンタル', 'ハーブ', 'ウッディ'],
        datasets: [{
            data: scores,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            r: {
                min: 0,
                max: 10,
                ticks: {
                    stepSize: 2, // ステップサイズ
                    font: {
                        size: isMobile ? 12 : 14 // スマホの場合は10px、それ以外は14px
                    }
                },
                pointLabels: {
                    font: {
                        size: isMobile ? 12 : 15 // スマホの場合は12px、それ以外は15px
                    }
                }
            }
        },
        plugins: {
            legend: {
                display: false // 凡例を非表示
            }
        }
    }
});
</script>
